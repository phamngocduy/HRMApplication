@model HRM.Databases_HDLaoDong.Models.hdPhuLucHD2
@using HRM.Databases.Models
@using HRM.Databases_HDLaoDong.Models
@{
    ViewBag.Title = "Details_PLHDSo2";
    var db = new HRMDB2Entities();
    var db0 = new HRM.Databases.Models.HRMDB0Entities();
    var cauhinh = db.hdCauHinh.FirstOrDefault();
    // in hd
    var cauHinh = db.hdCauHinh.FirstOrDefault();
    string TruongDH = cauHinh.Coquan;
    string SoHD = Model.hdChiTietHDLD.SoHD;
    string LoaiHD = Model.hdChiTietHDLD.LoaiHD;
    string ThoiHanHD = "";
    int ThoiHanHD_id = Model.hdChiTietHDLD.ThoihanHD_id;
    ThoiHanHD = db.dmThoiHanHD.Where(th => th.id == ThoiHanHD_id).FirstOrDefault().tenThoiHanHD;
    string nsdldOng_Ba = "Bà";
    int? nsdldGT_id = cauHinh.Gioitinh_id;
    string nsdlenGioiTinh = db0.dmGioiTinh.Where(gt => gt.id == nsdldGT_id).FirstOrDefault().tenGioiTinh;
    if (nsdlenGioiTinh == "Nam")
    {
        nsdldOng_Ba = "Ông";
    }
    string nsdldHoTen = cauHinh.HotenNSDLD;
    int QG_id = cauHinh.Quoctich_id;
    string nsdldQuocTich = db0.dmQuocGia.Where(qg => qg.id == QG_id).FirstOrDefault().tenQuocGia;
    int CV_id = cauHinh.Chucvu_id;
    string ChucVu = "";
    try
    {
        ChucVu = db0.dmChucDanhChuyenMon.Where(cv => cv.id == CV_id).FirstOrDefault().tenChucDanhChuyenMon;
    }
    catch
    {
    }
    string DiaChi = cauHinh.Diachi;
    string DienThoai = cauHinh.SDT;
    string nldOng_Ba = "Bà";
    int? nldGT_id = Model.hdChiTietHDLD.Gioitinh_id;
    string nldtenGioiTinh = db0.dmGioiTinh.Where(gt => gt.id == nldGT_id).FirstOrDefault().tenGioiTinh;
    if (nldtenGioiTinh == "Nam")
    {
        nldOng_Ba = "Ông";
    }
    string nldHoTen = Model.hdChiTietHDLD.HotenNLD;
    string nldNgaySinh = "";
    try
    {
        nldNgaySinh = Model.hdChiTietHDLD.Ngaysinh.Value.ToShortDateString();
    }
    catch
    {
    }
    string nldNoiSinh = Model.hdChiTietHDLD.Noisinh;
    int? NgheNghiep_id = Model.hdChiTietHDLD.Nghenghiep_id;
    string nldNgheNghiep = "";
    try
    {
        nldNgheNghiep = db0.dmNgheNghiep.Where(nn => nn.id == NgheNghiep_id).FirstOrDefault().tenNgheNghiep;
    }
    catch { }
    string nldDiaChiThuongTru = Model.hdChiTietHDLD.Diachithuongtru;
    string nldSoCMND = Model.hdChiTietHDLD.soCMND;
    string nldcmndNoiCap = "";
    int? cmndNoiCap_id = Model.hdChiTietHDLD.cmndNoicap;
    try
    {
        nldcmndNoiCap = db0.dmTinhThanh.Where(tt => tt.id == cmndNoiCap_id).FirstOrDefault().tenTinhThanh;
    }
    catch { }
    string nldcmncNgayCap = "";
    try
    {
        nldcmncNgayCap = Model.hdChiTietHDLD.cmndNgaycap.Value.ToShortDateString();
    }
    catch { }
    string nldQuocTich = "Việt Nam";
    int? DV_id = Model.hdChiTietHDLD.Donvi_id;
    string DonVi = db0.dmDonVi.Where(dv => dv.id == DV_id).FirstOrDefault().tenDonVi;
    int? CDCM_id = Model.hdChiTietHDLD.Chucdanh_id;
    string ChucDanhCM = db0.dmChucDanhChuyenMon.Where(cd => cd.id == CDCM_id).FirstOrDefault().tenChucDanhChuyenMon;
    int TGLV_id = Model.hdChiTietHDLD.ThoigioLV_id;
    string ThoiGioLamViec = db.dmThoiGioLamViec.Where(tg => tg.id == TGLV_id).FirstOrDefault().tenThoiGioLamViec;
    string MucLuong = Model.hdChiTietHDLD.Mucluongchinh;
    string DiaDiemLamViec = cauHinh.DiadiemLV;
    int tuNgay = Model.hdChiTietHDLD.NgayHL.Day;
    int tuThang = Model.hdChiTietHDLD.NgayHL.Month;
    int tuNam = Model.hdChiTietHDLD.NgayHL.Year;
    int? denNgay = null;
    try
    {
        denNgay = Model.hdChiTietHDLD.NgayhetHL.Value.Day;
    }
    catch
    {

    }
    int? denThang = null;
    try
    {
        denThang = Model.hdChiTietHDLD.NgayhetHL.Value.Month;
    }
    catch
    {
    }
    int? denNam = null;
    try
    {
        denNam = Model.hdChiTietHDLD.NgayhetHL.Value.Year;
    }
    catch
    {
    }
    double? HeSo = null;
    var Bac = "";
    var Ngach = "";
    var Nhom = "";
    var MaNhom = "";
    var BangLuong = Model.hdChiTietHDLD.Bangluong_id;

    int? nHSLuong_id = Model.hdChiTietHDLD.HSLuong_id;
    int? nNgach_id = Model.hdChiTietHDLD.Ngach_id;
    int? nNhom_id = Model.hdChiTietHDLD.Nhom_id;
    try
    {
        HeSo = db0.dmBangLuong.Where(bl => bl.id == nHSLuong_id).FirstOrDefault().hesoLuong;
    }
    catch
    {
    }
    try
    {
        Bac = db0.dmBangLuong.Where(bl => bl.id == nHSLuong_id).FirstOrDefault().bacLuong;
    }
    catch
    {
    }
    try
    {
        Ngach = db0.dmNgachVienChuc.Where(bl => bl.id == nNgach_id).FirstOrDefault().tenNgachVienChuc;
    }
    catch
    {
    }
    try
    {
        Nhom = db0.dmNhomNgachVienChuc.Where(bl => bl.id == nNhom_id).FirstOrDefault().tenNhomNgachVienChuc;
        MaNhom = db0.dmNhomNgachVienChuc.Where(bl => bl.id == nNhom_id).FirstOrDefault().maNhomNgachVienChuc;
    }
    catch
    {
    }
    float? K = null;
    try{
        K = float.Parse(Model.HSKLCV1) * float.Parse(Model.HSSLSV2);
    }catch{}
    TempData["Details"] = TempData["Details"];
}

<b style="margin-left:40%;font-size:large">Phụ Lục Hợp Đồng Số 2</b>
<div>
     @try{
    <p>@Html.ActionLink("Quay lại", TempData["Details"].ToString(), "ThemMoiHD", new { id = ViewBag.HD_id }, null)</p>
    }
    catch
    { <p>@Html.ActionLink("Quay lại", "Index", "HDNguoiLaoDong")</p>}
<p>
Số HĐ gốc<span style="margin-left:35px"></span>
<input id = "SoHD" style = "width:225px" value = "@Model.hdChiTietHDLD.SoHD" type="text" />
<span style = "margin-left:75px"></span>Ngày lập<span style="margin-left:11px"></span>
@Html.TextBoxFor(model => model.NgaylapPL, new { id = "NgayKy", style = "width:210px" })
</p>
<p>
    
</p>
<br />
<b>Nội dung PL</b><hr />
<p>
Hệ số lương<span style="margin-left:27px"></span>
<input id="HSL" style = "width:100px" value = "@Model.HSLuong" type="text" />
Mức lương tối thiểu
<input id="MLTT" class="money" name = "Mucluongtoithieu"  disabled = "true"  value = "@cauhinh.Mucluongchinh" type="text" style = "width:100px"/> VNĐ<span style="margin-left:10px"></span>
<span style="margin-left:5px"></span>Cơ số tiền lương<span style="margin-left:30px"></span>
<input id="CSTL" class="money" name = "CSTienluong"  disabled = "true"  value = "@cauhinh.Cosotienluong" type="text" style = "width:100px"/> VNĐ<span style="margin-left:10px"></span>
</p>
<p>
Hệ số CD,TĐ<span style="margin-left:23px"></span>
@Html.TextBoxFor(model => model.HSCDCM, new { id = "HSCDTD", style = "width:100px", disabled = "true" })
Hệ số nhiệm vụ<span style="margin-left:25px"></span>
@Html.TextBoxFor(model => model.HSNhiemvu, new { id = "HSNV", style = "width:140px", disabled = "true" })
<span style="margin-left:10px"></span>Hệ số KLCV K1<span style="margin-left:37px"></span>
@Html.TextBoxFor(model => model.HSKLCV1, new { id = "HSKLCVK1", style = "width:130px", disabled = "true" })

</p>
<p>
Hệ số SLSV K2<span style="margin-left:13px"></span>
@Html.TextBoxFor(model => model.HSSLSV2, new { id = "HSSLSVK2", style = "width:100px", disabled = "true" })
Hệ số HQCV đơn vị
@Html.TextBoxFor(model => model.HSHQCVdonvi, new { id = "HSHQCVDV", style = "width:140px", disabled = "true" })
<span style="margin-left:10px"></span>Hệ số HQCV cá nhân
@Html.TextBoxFor(model => model.HSHQCVcanhan, new { id = "HSHQCVCN", style = "width:130px", disabled = "true" })
</p>
<p>
Hiệu quả CV<span style="margin-left:25px"></span>
@Html.TextBoxFor(model => model.HQCV, new { id = "HQCV", style = "width:100px", disabled = "true" })
Hệ số thâm niên<span style="margin-left:19px"></span>
@Html.TextBoxFor(model => model.HSThamnien, new { id = "HSTN", style = "width:140px", disabled = "true" })
</p>
<p>

Thù lao(nếu có)<span style="margin-left:8px"></span>
<input id="TL" class="money" name = "Thulao" value = "@Model.Thulao" disabled = "true"  type="text" style = "width:200px"/> VNĐ
<span style="margin-left:80px"></span>Thu nhập
<input id="TN" onchange = "change()" name = "Thunhap" value = "@Model.Thunhap" disabled = "true"  type="text" style = "width:200px"/> VNĐ/Tháng
</p>

<p>
Ghi chú
</p>
@Html.TextAreaFor(model => model.Ghichu, new { style = "width: 802px; height: 70px" })    
</div>
<p style="margin-left: 85%">
    <a href="@Url.Action("Details_PL2", "CreateWordHD", new { id = Model.id })"><input id="btnInn" type="button"  value="In" style="width: 80px"/></a>
</p>

<script>
    $("#SoHDGoc").combobox().parent().find("input.ui-autocomplete-input").css("width", "222px");

    $(".custom-combobox-input").removeClass("ui-state-default");
    $(".custom-combobox-input").removeClass("ui-widget-content");
    $(".custom-combobox-width").removeClass("ui-width-default");
    $(".custom-combobox-input").removeClass("ui-corner-left");
    $(".custom-combobox-toggle").removeClass("ui-state-default");
    $(function () {
        $("[id=NgayKy]").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: "dd/mm/yy",
            yearRange: 'c-100:c+100'
        });
        $("[id=NgayCoHieuLuc]").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: "dd/mm/yy"
        });
        $("[id=NgayHetHieuLuc]").datepicker({
            changeMonth: true,
            changeYear: true,
            dateFormat: "dd/mm/yy"
        });
    });
</script>

<script src="http://localhost:26919/Scripts/jquery.mask.min.js" type="text/javascript"></script>
<script>
    $('.money').mask('0.000.000.000', { reverse: true });
</script>
<script>
    document.getElementById("TN").onblur = function () {
        this.value = parseFloat(this.value.replace(/,/g, ""))

                    .toString()
                    .replace(/\B(?=(\d{3})+(?!\d))/g, ".");

        document.getElementById("TN").value = this.value.replace(/,/g, "")

    }

</script>
<div id="dvInHD" style="display:none">
    <div style="float:left;font-size:18px; padding:0px;margin:0px;">@Html.Raw(TruongDH)
    </div> 
    <div style="float:right; padding:0px;margin:0px;"><b>CỘNG HÒA XÃ HỘI CHỦ NGHĨA VIỆT NAM</b>
    <p style=" padding:0px;font-size:18px; margin:0px; text-align:center">Độc lập - Tự do - Hạnh phúc</p>
    </div>
    <br /><br /><br /><br />
    <p style=" padding:0px;font-size:18px; margin:0px; text-align:center"><b>PHỤ LỤC SỐ 2 HỢP ĐỒNG LAO ĐỘNG</b></p>
    <br />
    <div style="float:left; padding:0px;margin:0px;">
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Căn cứ Quy định tạm thời về cách tính lương mới ban hành kèm theo Quyết định số: </p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">468/2008/QĐ-VL ngày 24 tháng11năm 2008 của Hiệu trưởng Trường Đại học dân lập Văn Lang,</p>
    <table>
    <tbody>
    <tr>
    <td style = "width:370px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px;margin-bottom:3px">Chúng tôi, một bên là @Html.Raw(nsdldOng_Ba) <b>@Html.Raw(nsdldHoTen)</span> </td>
    <td><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px;margin-bottom:3px">Quốc tịch: @Html.Raw(nsdldQuocTich)</span></td>
    </tr>
    </tbody>
    </table> 
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Chức vụ:          @Html.Raw(ChucVu)</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Đại diện cho:     @Html.Raw("Trường Đại học Dân lập Văn Lang")</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Địa chỉ: @Html.Raw(DiaChi)</p> 
    <table>
    <tbody>
    <tr>
    <td style = "width:370px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px">Và một bên là @Html.Raw(nldOng_Ba) @Html.Raw(nldHoTen)</span> </td>
    <td><span style="font-size:18px;padding:0px;margin:0px; text-align:left;">Quốc tịch: @Html.Raw(nldQuocTich)</span></td>
    </tr>
    </tbody>
    </table> 
    <table>
    <tbody>
    <tr>
    <td style = "width:370px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px">Sinh ngày: @Html.Raw(nldNgaySinh)</span> </td>
    <td><span style="font-size:18px;padding:0px;margin:0px; text-align:left">tại: @Html.Raw(nldNoiSinh)</span></td>
    </tr>
    </tbody>
    </table>
    <table>
    <tbody>
    <tr>
    <td style = "width:370px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px">Nghề nghiệp: @Html.Raw(nldNgheNghiep)</span> </td>
    <td><span style="font-size:18px;padding:0px;margin:0px; text-align:left">chức danh: @Html.Raw(ChucDanhCM);</span></td>
    </tr>
    </tbody>
    </table>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Địa chỉ thường trú: @Html.Raw(nldDiaChiThuongTru)</p>
    <table>
    <tbody>
    <tr>
    <td style = "width:190px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left; margin-left:-3px">Số CMND: @Html.Raw(nldSoCMND)</span> </td>
    <td style = "width:175px"><span style="font-size:18px;padding:0px;margin:0px; text-align:left">Cấp ngày @Html.Raw(nldcmncNgayCap)</span></td>
    <td><span style="font-size:18px;padding:0px;margin:0px; text-align:left">tại CA. @Html.Raw(nldcmndNoiCap)</span></td>
    </tr>
    </tbody>
    </table>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Hai bên thỏa thuận ký kết phụ lục hợp đồng lao động như sau:</p> 
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Bổ sung điều 3 khoản 1 trong Hợp đồng lao động số @Html.Raw(Model.hdChiTietHDLD.SoHD) ngày @Html.Raw(Model.hdChiTietHDLD.NgayHL.Day) tháng @Html.Raw(Model.hdChiTietHDLD.NgayHL.Month) năm @Html.Raw(Model.hdChiTietHDLD.NgayHL.Year) đã ký kết như sau: </p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Thu nhập = [(HSL x MLTT) + (CSTL x C x T)] x K x H + TL</p>
        <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Hệ số lương (HSL): @Html.Raw(Model.HSLuong);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Mức lương tối thiểu (MLTT): Theo quy định của nhà trường, tại thời điểm ngày </p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:12px"></span>@Html.Raw(Model.hdChiTietHDLD.NgayHL.ToShortDateString()) là @Html.Raw(Model.Mucluongtoithieu)đ;</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Cơ số tiền lương (CSTL): Theo quy định của nhà trường, tại thời điểm ngày </p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:12px"></span>@Html.Raw(Model.hdChiTietHDLD.NgayHL.ToShortDateString()) là: @Html.Raw(Model.CSTienluong)đ;</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Hệ số chức danh, trình độ: C = C1 x C2;</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:12px"></span>+  Hệ số chức danh chuyên môn, trình độ C1 = @Html.Raw(Model.HSCDCM);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:12px"></span>+  Hệ số nhiệm vụ C2 = @Html.Raw(Model.HSNhiemvu);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Hệ số thâm niên T = 1+ 0,003 x T1 = @Html.Raw(Model.HSThamnien) (T1 là số năm công tác tại Trường);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Khối lượng công việc K = @Html.Raw(K);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	Hiệu quả công việc H: mới tuyển dụng chưa đánh giá hiệu quả;</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">-	TL: @Html.Raw(Model.Thulao) Thù lao vượt giờ hoặc ngoài giờ (nếu có);</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Thu nhập: @Html.Raw(Model.Thunhap) đồng/tháng (không bao gồm TL).</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Phụ lục này đi kèm với Hợp đồng lao động số @Html.Raw(Model.hdChiTietHDLD.SoHD) ngày @Html.Raw(Model.hdChiTietHDLD.NgayHL.Day) tháng @Html.Raw(Model.hdChiTietHDLD.NgayHL.Month) năm</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">@Html.Raw(Model.hdChiTietHDLD.NgayHL.Year). Phụ lục được lập thành 02 (hai) bản có giá trị như nhau, người lao động giữ 01 bản,</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">người sử dụng lao động giữ 01 bản.</p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:12px"></span></p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left">Phụ lục hợp đồng làm tại Phòng Kế hoạch và Quản lý nhân lực ngày @Html.Raw(DateTime.Today.Day) tháng @Html.Raw(DateTime.Today.Month) năm @Html.Raw(DateTime.Today.Year)</p>
    <br />
    <p style="font-size:18px;padding:0px;margin:0px; text-align:left"><span style="margin-left:30px"></span><b>Người lao động</b>
    <span style="font-size:18px;margin-left:270px"><b>Người sử dụng lao động</b></span>
    </p>
    <p style="font-size:18px;padding:0px;margin:0px; text-align:right"><span style = "margin-right:90px"><b>Hiệu trưởng</b></span></p>
    <br /><br /><br /><br /><br />
    <p style="font-size:18px;padding:0px;margin:0px; text-align:right"><span style = "margin-right:82px"><b>@Html.Raw(nsdldHoTen)</b></span></p>
    </div>     
</div>
<script type="text/javascript">
    $("#btnIn").live("click", function () {
        var divContents = $("#dvInHD").html();
        var printWindow = window.open('', '', 'height=600,width=750');
        printWindow.document.write('<html><head><title></title>');
        printWindow.document.write('</head><body >');
        printWindow.document.write(divContents);
        printWindow.document.write('</body></html>');
        printWindow.document.close();
        printWindow.print();
    });
</script>